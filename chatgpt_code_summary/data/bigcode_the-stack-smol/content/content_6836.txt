def tsd_section_name(pagename):
    articlename = pagename.split('/')[1]
    sectionname_new = ''
    if 'ДО' in pagename.split('/'):
        sectionname_new = articlename
    else:
        if articlename.endswith((' 1', ' 2', ' 3', ' 4')):
            sectionname_new = articlename + '-1'
        else:
            sectionname_new = articlename + '1'
    return sectionname_new


def tsd_calc_pagenum_offset(indexpage):
    offsets = {
        'Толковый словарь. Том 1 (Даль 1903).djvu': 17,
        'Толковый словарь. Том 2 (Даль 1905).djvu': 2,
        'Толковый словарь. Том 3 (Даль 1907).djvu': 2,
        'Толковый словарь. Том 4 (Даль 1909).djvu': 4,
        'Толковый словарь Даля (2-е издание). Том 1 (1880).pdf': 90,
        'Толковый словарь Даля (2-е издание). Том 2 (1881).pdf': 9,
        'Толковый словарь Даля (2-е издание). Том 3 (1882).pdf': 8,
        'Толковый словарь Даля (2-е издание). Том 4 (1882).pdf': 8,
        'Толковый словарь Даля (1-е издание). Часть 1 (1863).pdf': 2,
        'Толковый словарь Даля (1-е издание). Часть 2 (1865).pdf': -626,
        'Толковый словарь Даля (1-е издание). Часть 3 (1865).pdf': 1,
        'Толковый словарь Даля (1-е издание). Часть 4 (1866).pdf': 3,
    }
    return offsets[indexpage]


def tsd_calc_volume(indexpage, edition, page_data):
    v = None
    volumes = [
        {'Толковый словарь Даля (1-е издание). Часть 1 (1863).pdf': 1,
         'Толковый словарь Даля (1-е издание). Часть 2 (1865).pdf': 2,
         'Толковый словарь Даля (1-е издание). Часть 3 (1865).pdf': 3,
         'Толковый словарь Даля (1-е издание). Часть 4 (1866).pdf': 4, },
        {'Толковый словарь Даля (2-е издание). Том 1 (1880).pdf': 1,
         'Толковый словарь Даля (2-е издание). Том 2 (1881).pdf': 2,
         'Толковый словарь Даля (2-е издание). Том 3 (1882).pdf': 3,
         'Толковый словарь Даля (2-е издание). Том 4 (1882).pdf': 4, },
        {'Толковый словарь. Том 1 (Даль 1903).djvu': 1,
         'Толковый словарь. Том 2 (Даль 1905).djvu': 2,
         'Толковый словарь. Том 3 (Даль 1907).djvu': 3,
         'Толковый словарь. Том 4 (Даль 1909).djvu': 4, }
    ]
    try:
        v = volumes[edition - 1][string_strip(indexpage)]
    except:
        print('Ошибка при определении тома по названию индексной страницы из тега <pages>: %s' % page_data['pagename'])
        pass
    return v


def string_strip(s):
    return str(s).replace('\u200e', '').replace('&lrm;', '').replace('&#8206;', '').strip()
